#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è PostgreSQL –≤ Railway –ø—Ä–æ–µ–∫—Ç
# –í–ù–ò–ú–ê–ù–ò–ï: Railway CLI –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ë–î
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ

echo "üöÇ Railway PostgreSQL Setup Script"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
if ! railway whoami &>/dev/null; then
    echo "‚ùå –í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Railway"
    echo "üìù –í—ã–ø–æ–ª–Ω–∏—Ç–µ: railway login"
    exit 1
fi

echo "‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Railway"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤—è–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
if [ ! -f ".railway/project.json" ]; then
    echo "‚ö†Ô∏è  –ü—Ä–æ–µ–∫—Ç –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ Railway"
    echo "üìù –í—ã–ø–æ–ª–Ω–∏—Ç–µ: railway link"
    exit 1
fi

echo "‚úÖ –ü—Ä–æ–µ–∫—Ç –ø—Ä–∏–≤—è–∑–∞–Ω"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo "üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
railway variables

echo ""
echo "‚ö†Ô∏è  –í–ê–ñ–ù–û: PostgreSQL –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Railway Dashboard"
echo ""
echo "üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ https://railway.app/dashboard"
echo "2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç 'spectacular-laughter'"
echo "3. –ù–∞–∂–º–∏—Ç–µ '+ New' ‚Üí 'Database' ‚Üí 'Add PostgreSQL'"
echo "4. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç DATABASE_URL –∏ –ø–µ—Ä–µ–¥–µ–ø–ª–æ–∏—Ç –ø—Ä–æ–µ–∫—Ç"
echo ""
echo "‚úÖ –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è PostgreSQL –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ —É–∂–µ DATABASE_URL
if railway variables 2>/dev/null | grep -q "DATABASE_URL"; then
    echo "‚úÖ DATABASE_URL —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    echo "‚úÖ PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω!"
else
    echo "‚ö†Ô∏è  DATABASE_URL –Ω–µ –Ω–∞–π–¥–µ–Ω"
    echo "   PostgreSQL –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç"
fi

